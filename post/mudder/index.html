<!doctype html>
<head><meta charset="utf-8" />
<title>Announcing: Mudder.js</title>
<link href="/atom.xml" type="application/atom+xml" rel="alternate" />
<meta name="description" content="Generate lexicographically-spaced strings. And for fun, encode numbers in arbitrary-base number systems." />
<meta name="twitter:card" value="summary">
<meta property="og:title" content="Announcing: Mudder.js" />
<meta property="og:type" content="article" />
<meta property="og:url" content="post/mudder/index.html" />
<meta property="og:image" content="https://fasiha.github.io/post/mudder/flame.jpg" />
<meta property="og:description" content="Generate lexicographically-spaced strings. And for fun, encode numbers in arbitrary-base number systems." />
<style>@media print {
  *,
  *:before,
  *:after {
    background: transparent !important;
    color: #000 !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  a,
  a:visited {
    text-decoration: underline;
  }

  a[href]:after {
    content: " (" attr(href) ")";
  }

  abbr[title]:after {
    content: " (" attr(title) ")";
  }

  a[href^="#"]:after,
  a[href^="javascript:"]:after {
    content: "";
  }

  pre,
  blockquote {
    border: 1px solid #999;
    page-break-inside: avoid;
  }

  thead {
    display: table-header-group;
  }

  tr,
  img {
    page-break-inside: avoid;
  }

  img {
    max-width: 100% !important;
  }

  p,
  h2,
  h3 {
    orphans: 3;
    widows: 3;
  }

  h2,
  h3 {
    page-break-after: avoid;
  }
  .parallax {
    background-attachment: scroll;
  }
}

pre,
code {
  font-family: Menlo, Monaco, Consolas, Inconsolata, "Andale Mono", "Fira Code", "Lucida Console", "Lucida Sans Typewriter", "Courier New", monospace;
}

pre {
  padding: .5rem;
  line-height: 1.25;
  overflow-x: scroll;
}

a,
a:visited {
  color: #3498db;
}

a:hover,
a:focus,
a:active {
  color: #2980b9;
}

.modest-no-decoration {
  text-decoration: none;
}

html {
  font-size: 12px;
}

@media screen and (min-width: 32rem) and (max-width: 48rem) {
  html {
    font-size: 15px;
  }
}

@media screen and (min-width: 48rem) {
  html {
    font-size: 16px;
  }
}

body {
  line-height: 1.85;
}

p,
.modest-p {
  font-size: 1rem;
  margin-bottom: 1.3rem;
}

h1,
.modest-h1,
h2,
.modest-h2,
h3,
.modest-h3,
h4,
.modest-h4 {
  margin: 1.414rem 0 .5rem;
  font-weight: inherit;
  line-height: 1.42;
}

h1,
.modest-h1 {
  margin-top: 0;
  font-size: 3.998rem;
}

h2,
.modest-h2 {
  font-size: 2.827rem;
}

h3,
.modest-h3 {
  font-size: 1.999rem;
}

h4,
.modest-h4 {
  font-size: 1.414rem;
}

h5,
.modest-h5 {
  font-size: 1.121rem;
}

h6,
.modest-h6 {
  font-size: .88rem;
}

small,
.modest-small {
  font-size: .707em;
}

/* https://github.com/mrmrs/fluidity */

img,
canvas,
iframe,
video,
svg,
select,
textarea {
  max-width: 100%;
}

html {
  font-size: 18px;
  max-width: 100%;
  height: 100%;
}

body {
  height: 100%;
  color: #444;
  font-family: "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
  font-weight: 300;
  margin: 0 auto;
  max-width: 48rem;
  line-height: 1.45;
  padding: 0 .25rem .25rem;
}

h1,
h2,
h3 {
  border-bottom: 2px solid #fafafa;
  margin-bottom: 1.15rem;
  padding-bottom: .5rem;
  text-align: center;
}

blockquote {
  border-left: 8px solid #fafafa;
  padding: 0.1em 1rem;
}

pre,
code {
  background-color: #fafafa;
}

figure {
  position: relative;
  text-align: center;
}
figcaption {
  color: #999;
  font-size: 0.9em;
  margin-top: 0.5em;
}

/* https://css-tricks.com/full-width-containers-limited-width-parents/ */
.full-width {
  width: 100vw;
  position: relative;
  left: 50%;
  right: 50%;
  margin-left: -50vw;
  margin-right: -50vw;
}
.no-top {
  margin-top: 0px;
  padding-top:0px;
}
ul.top-nav {
  padding-left: 0;
}
ul.top-nav li {
  display: inline;
  list-style-type: none;
  padding-right: 1em;
}
table{
  border-spacing: 0;
  border-collapse: collapse;
}
table th, table td{
  border: 1px solid #eee;
  padding: 6px 13px;
}
table tr:nth-child(2n) {
  background-color: #f6f8f6;
}
div.img-svg{position: relative; display: inline-block;}
div.img-svg img{display: block;max-width: 100%; height: auto;}
div.img-svg svg{position:absolute; margin:0; padding:0; top:0; left:0;}
svg.overlay {opacity:0}
svg.overlay:hover {opacity:1}
</style>
<style>/* Tomorrow Night Eighties Theme */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
  color: #999999;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
  color: #f2777a;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
  color: #f99157;
}

/* Tomorrow Yellow */
.hljs-attribute {
  color: #ffcc66;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
  color: #99cc99;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
  color: #6699cc;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
  color: #cc99cc;
}

.hljs {
  display: block;
  overflow-x: auto;
  background: #2d2d2d;
  color: #cccccc;
  padding: 0.5em;
}

.hljs-emphasis {
  font-style: italic;
}

.hljs-strong {
  font-weight: bold;
}
</style>

</head>
<figure class="full-width no-top"><img src="flame.jpg"></figure>  <ul class="top-nav">
    <li><a href="/">Blog</a></li>
    <li><a href="/#contact">Contact</a></li>
    <li><a href="/atom.xml">Feed</a></li>
  </ul><h1>Announcing: Mudder.js</h1><p><em>Updated on Thu, 01 Jun 2017 06:17:23 GMT, tagged with â€˜techâ€™â€”â€˜mathâ€™.</em></p><p>Iâ€™m happy to announce the publication of a fun, potentially even useful, library I worked on over September 2016. (This post started as a â€œWork In Progressâ€-kind of post, but apologizing was more painful than just finishing it and shipping it!)</p>
<p><a href="https://github.com/fasiha/mudderjs"><strong>Mudder.js</strong></a> is a JavaScript library that lets you create lexicographically-evenly-spaced strings. So for example, you can ask for the ten strings that lexicographically sort between two input strings, and you'll get just that, ten short-as-possible evenly-spaced sorted strings.</p>
<p>As a fun bonus, it simplifies converting between JavaScript numbers and their stringy representations in arbitrary bases (non-base-ten) and using arbitrary symbols.</p>
<p><strong>Fun Â§</strong> First things first. We can specify a base-214 number system that uses the 214 Kangxi radicals used by the Chinese to organize Chinese characters, i.e., 0 through 20 is ä¸€ä¸¨ä¸¶ä¸¿ä¹™äº…äºŒäº äººå„¿å…¥å…«å†‚å†–å†«å‡ å‡µåˆ€åŠ›å‹¹åŒ•. Example: one billion is ç–‹äº é¼ å°¢ in this number system, while one-billion-plus-one is ç–‹äº é¼ å°¸. Another example: Confuciusâ€™ name is written <ruby>å­”<rt>kÇ’ng</rt></ruby><ruby>å­<rt>zÇ</rt></ruby> and consists of the radicals å­ä¹šå­, which in this Kangxi number system is 8170â€”maybe that has some cosmic significance?</p>
<pre class="js"><code class="hljs javascript"><span class="hljs-keyword">var</span> kangxi = <span class="hljs-string">`ä¸€ä¸¨ä¸¶ä¸¿ä¹™äº…äºŒäº äººå„¿å…¥å…«å†‚å†–å†«å‡ å‡µåˆ€åŠ›å‹¹åŒ•åŒšåŒ¸ååœå©å‚å¶åˆå£å›—åœŸå£«
              å¤‚å¤Šå¤•å¤§å¥³å­å®€å¯¸å°å°¢å°¸å±®å±±å·å·¥å·±å·¾å¹²å¹ºå¹¿å»´å»¾å¼‹å¼“å½å½¡å½³å¿ƒæˆˆæˆ¶æ‰‹æ”¯æ”´
              æ–‡æ–—æ–¤æ–¹æ— æ—¥æ›°æœˆæœ¨æ¬ æ­¢æ­¹æ®³æ¯‹æ¯”æ¯›æ°æ°”æ°´ç«çˆªçˆ¶çˆ»çˆ¿ç‰‡ç‰™ç‰›çŠ¬ç„ç‰ç“œç“¦ç”˜
              ç”Ÿç”¨ç”°ç–‹ç–’ç™¶ç™½çš®çš¿ç›®çŸ›çŸ¢çŸ³ç¤ºç¦¸ç¦¾ç©´ç«‹ç«¹ç±³ç³¸ç¼¶ç½‘ç¾Šç¾½è€è€Œè€’è€³è¿è‚‰è‡£è‡ª
              è‡³è‡¼èˆŒèˆ›èˆŸè‰®è‰²è‰¸è™è™«è¡€è¡Œè¡£è¥¾è¦‹è§’è¨€è°·è±†è±•è±¸è²èµ¤èµ°è¶³èº«è»Šè¾›è¾°è¾µé‚‘é…‰é‡†
              é‡Œé‡‘é•·é–€é˜œéš¶éš¹é›¨é’éé¢é©éŸ‹éŸ­éŸ³é é¢¨é£›é£Ÿé¦–é¦™é¦¬éª¨é«˜é«Ÿé¬¥é¬¯é¬²é¬¼é­šé³¥é¹µé¹¿
              éº¥éº»é»ƒé»é»‘é»¹é»½é¼é¼“é¼ é¼»é½Šé½’é¾é¾œé¾ `</span>.replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">''</span>);
<span class="hljs-keyword">var</span> rad = <span class="hljs-keyword">new</span> mudder.SymbolTable(kangxi);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Confucius: '</span>, rad.stringToNumber(<span class="hljs-string">'å­ä¹šå­'</span>));
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Billion:'</span>, rad.numberToString(<span class="hljs-number">1e9</span>));</code></pre>
<p>The above code snippet should be live, thanks to the Klipse pluginâ€”feel free to edit the code and instantaneously see the result!</p>
<p><strong>Business Â§</strong> This numerology actually was an unexpected stepping stone to a more serious use. In NoSQL databases like CouchDB or Redis, entries are indexed by stringy keys and I needed a way to reliably insert, delete, and reorder entries to maintain an external ordering without knowing ahead of time how many entries or how they would be ordered. Mudder.js makes it easy to ask for three strings that are lexicographically between, say, 'anhui' and 'azazel', using only the 26 lower-case letters:</p>
<pre class="js"><code class="hljs javascript"><span class="hljs-built_in">console</span>.log(mudder.alphabet.mudder(<span class="hljs-string">'anhui'</span>, <span class="hljs-string">'azazel'</span>, <span class="hljs-number">3</span>))
<span class="hljs-comment">// [ 'aq', 'at', 'aw' ]</span></code></pre>
<p>With Mudder.js, I can always call <code>mudder</code> (i.e., â€œmidderâ€) to get one or more strings lexicographically between any two stringy keys. Feel free to edit the code aboveâ€”the results should update instantaneously thanks to the magical <a href="http://blog.klipse.tech/klipse/2017/03/28/klipse-explained.html">Klipse</a> plugin.</p>
<p>(Iâ€™ve been referring to â€œlexicographicâ€ ordering, which is a common (though not the only!) sort order on strings, that is, a way of saying whether a string is â€œless thanâ€, â€œequal toâ€, or â€œgreater thanâ€ another. Javaâ€™s <a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html#compareTo-java.lang.String-"><code>String.compareTo</code></a> docs are reasonably clear.)</p>
<p>Most of the complete details are in the <a href="https://github.com/fasiha/mudderjs">literate source</a>, which is actually very verbose ğŸ™„. As usual, the literate methodologyâ€”of explaining in prose what I was doing and then showing code that did itâ€”helped a lot, by enormously decreased the activation energy to refactoring bad code. Itâ€™s more painful to contort oneâ€™s prose explanations to positively spin bad design than just to refactor and make it more cogent.</p>
<p>Near the end though, I tapered off with the literate code because I needed to get on with Real Life and use the library. I didnâ€™t publish the library for this reason, but Iâ€™m happy to complete several tests, fix several bugs, and write up the API documentation to publish it now.</p>
<p><strong>JavaScript stack Â§</strong> I also switched from using ES2015 modules, Rollup, and Babel (imitating <a href="https://github.com/d3/d3">D3v4</a>, e.g., <a href="https://github.com/d3/d3-array"><code>d3-array</code></a>) to using simple Node.js <code>require</code>/<code>module.exports</code> modules, Browserify, and Google Closure Compiler. Not only do the former require much ceremony to set up, they also make me do manual dead-code elimination (by carefully specifying with items in a module to import). I am very pleased with using much simpler tools (Node.js modules and Browserify) and just leaning on the powerful Google Closure Compiler to do dead-code elimination for meâ€”as a bonus, it also handles minification and transpilation to ES5. The <a href="https://github.com/mafintosh/hypercore">Dat Project repos</a> influenced me to try this simpler approachâ€”they still donâ€™t do the Google Closure Compiler, that part I got from my ClojureScript background ğŸ’ª.</p>
<p><strong>Klipse Â§</strong> Perhaps I can note here that I might have had a small role to play in introducing to Klipseâ€™s Yehonathan Sharvit (<a href="https://twitter.com/viebel">@viebel</a>) the role <em>he</em> could play in giving voice once again to Alan Kayâ€™s expectation of interactive computing. In <a href="http://blog.klipse.tech/javascript/2016/06/20/blog-javascript.html#alan-kays-vision">â€œA new way of blogging about javascriptâ€</a>, @viebel quotes an <a href="http://www.drdobbs.com/architecture-and-design/interview-with-alan-kay/240003442?pgno=2">interview</a> where Kay uses Wikipedia to illustrate how unambitious our vision for learning and interacting with computers is:</p>
<blockquote>
<p>go to the article on Logo, can you write and execute Logo programs? Are there examples? No. The Wikipedia people didnâ€™t even imagine that, in spite of the fact that theyâ€™re on a computer.</p>
</blockquote>
<p>Kayâ€™s own <a href="https://youtu.be/Eg_ToU7m1MI?t=2m15s">presentations</a>, of course created and executed in Smalltalk VM, provided me with a visceral feeling of this disappointing lack of vision. For him, itâ€™s obvious that we should illustrate our thinking right there, with examples in the same medium as the prose that expresses it. No, it does not make any sense to have to install a program, switch to a command-line, or open a new browser tab to try a programming language, or verify a numerical fact, or test an optical illusion as Kay does here.</p>
<p>I see immediately-interactive code is the sister to literate programming. In the last couple of projects (e.g., <a href="../ebisu">Ebisu</a>) Iâ€™ve worked out a very opinionated, personalized workflow for the latter. In this webpage, Iâ€™m happy to acknowledge the fantastic work Klipse has done in making <a href="http://blog.klipse.tech/klipse/2017/03/28/klipse-explained.html">interactive JavaScript blogs</a> dead-simple. Kudos, Klipse!</p>
<p>(That said, the Klipse plugin does weigh in at 1.1 MB minified (225 kB minified+gzipped). In case its download was blocked, the much smaller Mudder.js has been loaded into this window, and should be available in your browserâ€™s JavaScript Console.)</p>
<p>(Banner credit: self, with Gimpâ€™s Flame effect.)</p>
<script src="mudder.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://storage.googleapis.com/app.klipse.tech/css/codemirror.css">
<script>
window.klipse_settings = {
  selector_eval_js: '.javascript',
  };
</script>
<script src="https://storage.googleapis.com/app.klipse.tech/plugin_prod/js/klipse_plugin.min.js"></script>
<p>
<small>Previous: <a href="/post/japanese-study-books/">Japanese study books</a><br>Next: <a href="/post/wip/">Works in progress</a></small>
</p>
